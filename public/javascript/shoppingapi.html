<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../../node_modules/bootstrap-icons/font/bootstrap-icons.css">
    <link rel="stylesheet" href="../../node_modules/bootstrap/dist/css/bootstrap.css">
    <style>

    </style>
    <script>
        function load_details() {
            fetch("http://fakestoreapi.com/products/categories")
                .then(function (res) {
                    return res.json();
                })
                .then(function (categories) {
                    categories.unshift("all");
                    for (var cat of categories) {
                        var option = document.createElement("option");
                        option.text = cat.toUpperCase();
                        option.value = cat;

                        document.querySelector("#select_cat").appendChild(option);
                    }
                })
        }
        function load_products(url) {
            document.querySelector("#main_prod").innerHTML = "";
            fetch(url)
                .then(function (res) {
                    return res.json();
                })
                .then(function (products) {
                    for (var prod of products) {
                        var div = document.createElement("div");
                        div.className = "card m-2 p-2";
                        div.style.width = "250px";
                        div.innerHTML = `
                    <img src=${prod.image} height="200" class="card-img-top">
                    <div class="card-header " style="height:140px">${prod.title} </div>
                    <div class="card-body">
                    <dl>
                        <dt>Price</dt>
                        <dd>${prod.price}</dd>
                        <dt>Rating</dt>
                        <dd><span class="bi bi-star-fill text-success "></span> ${prod.rating.rate} [ ${prod.rating.count}]</dd>
                    </dl>    
                    </div>
                    <div class="card-footer"><button onclick="addclick(${prod.id})" class="btn btn-danger w-100" "><span class="bi bi-cart2"></span>Add to Cart</button></div>
                    `;
                        document.querySelector("#main_prod").appendChild(div);
                    }
                })
        }
        function addclick(id) {
            fetch(`http://fakestoreapi.com/products/${id}`)
                .then(function (res) {
                    return res.json();
                })
                .then(function (product) {

                    alert(`${product.title} \n Add to Cart`);
                    cart.push(product);
                    prodcart();
                })

        }
        var cart = [];
        function prodcart() {
            document.querySelector("#cartadd").innerHTML = cart.length;
        }
        function categories_Change() {
            var categoryselect = document.querySelector("#select_cat").value;
            if (categoryselect == "all") {
                load_products(`http://fakestoreapi.com/products`)
            }
            load_products(`http://fakestoreapi.com/products/category/${categoryselect}`);

        }
        function showproducts() {
            document.querySelector("tbody").innerHTML="";
            for(var item of cart){

          
            var trow = document.createElement("tr");
          
            var ttitle=document.createElement("td");
            var tprice=document.createElement("td");
            var timage=document.createElement("td");
         
            ttitle.innerHTML=item.title;
             tprice.innerHTML=item.price;
             timage.innerHTML=`<img src=${item.image} height="50" width="50">`
             trow.appendChild(ttitle);
             trow.appendChild(tprice);
             trow.appendChild(timage);

             document.querySelector("tbody").appendChild(trow);

        }
        }
        function body_load() {
            load_details();
            load_products("http://fakestoreapi.com/products");
            prodcart();
        }
    </script>
</head>

<body class=" container-fluid " onload="body_load()">
    <header class="bg-danger text-white text-center m-2 p-2">
        <h2><span class="bi bi-cart4"></span> Shopping</h2>
    </header>
    <section class="row">
        <nav class="col-2">
            <div>
                <label>Select Category</label>
                <select id="select_cat" class="form-select" onchange="categories_Change()">

                </select>
            </div>
        </nav>
        <main id="main_prod" class="col-8 d-flex flex-wrap overflow-auto" style="height: 30rem;">

        </main>
        <aside class="col-2">
            <button class="btn btn-danger w-100" onclick="showproducts() "data-bs-target="#modalshow " data-bs-toggle="modal"><span class="bi bi-cart"></span> [ <span
                    id="cartadd"></span> ] Your Cart</button>
        </aside>
    </section>
    <div class=" modal  " id="modalshow">
        <div class=" modal-dialog  ">
          <div class=" modal-content">
            <div class=" modal-header" data-bs-dismiss="modal">
                
                <h2>Your Cart Items</h2>
                <button class="btn btn-close"></button>
            </div>
            <div class=" modal-body">
                <table id="proddetail" class="table  table-hover">
                    <thead>
                    <tr>
                        <th>Title</th>
                        <th>Price</th>
                        <th>Preview</th>
                    </tr>
                </thead>
                <tbody></tbody>
                </table>
            </div>
            <div class=" modal-footer">
                <button class="btn btn-primary" data-bs-dismiss="modal">OK</button>
            </div>
          </div>
        </div>
    </div>
    <script src="../../node_modules/jquery/dist/jquery.js"></script>
    <script src="../../node_modules/bootstrap/dist/js/bootstrap.bundle.js"></script>
</body>

</html>